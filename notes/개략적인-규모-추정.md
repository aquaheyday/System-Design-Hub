## 개략적인 규모 추정

### 2의 제곱수
데이터 볼륨의 단위를 2의 제곱수로 표현하면 최소 단위는 1바이트이고, 8비트로 구성된다.  
ASCII 문자 하나가 차지하는 메모리 크기가 1바이트이다.  
| 2의 x 제곱 | 근사치 | 이름 | 축약형 |
|----------|----------|----------|----------|
| 10 | 1천(thousand) | 1킬로바이트(Kilobyte) | 1KB |
| 20 | 1백만(million) | 1메가바이트(Megabyte) | 1MB |
| 30 | 1억(billion) | 1기가바이트(Gigabyte) | 1GB |
| 40 | 1조(trillion) | 1테라바이트(Terabyte) | 1TB |
| 50 | 1000조(quadrillion) | 1페타바이트(Petabyte) | 1PB |

## 응답 지연 값
구글의 제프 딘은 2010년에 통상적인 컴퓨터에서 구현된 연산들의 응답지연 값을 공개한 바 있다.  
현재는 컴퓨터가 더 빨라져서 유효하진않지만 연산처리 짐작에 도움을 준다.  
| 연산명 | 시간 |
|----------|----------|
| L1 캐시 참조 | 0.5ns |
| 분기 예측 오류(branch mispredict)) | 5ns |
| L2 캐시 참조 | 7ns |
| 뮤텍스(mutex) 락/언락 | 100ns |
| 주 메모리 참조 | 100ns |
| Zippy로 1KB 압축 | 10,000ns=10μs |
| 1 Gbps 네트워크로 2KB 전송 | 20,000ns=20μs |
| 메모리에서 1MB 순차적으로 read | 250,000ns=250μs |
| 같은 데이터 센터 내에서의 메시지 왕복 지연시간 | 500,000ns=500μs |
| 디스크 탐색(seek) | 10,000,000ns=10ms |
| 네트워크에서 1MB 순차적으로 read | 10,000,000ns=10ms |
| 디스크에서 1MB 순차적으로 read | 30,000,000ns=30ms |
| 한 패킷의 CA(캘리포니아)로 부터 네덜란드까지 왕복 지연시간 | 150,000,000ns=150ms |

위 수치들을 분석하면 다음과 같은 결론이 나온다.
- 메모리는 빠르지만 디스크는 아직 느리다.
- 디스크 탐색(seek)은 가능한 피하자.
- 단순 압축 알고리즘은 빠르다.
- 데이터를 인터넷으로 전송하기 전에 가능하면 압축하자.
- 데이터 센터는 보통 여러 지역(region)에 분산되어 있고, 센터들 간에 데이터를 주고받는 데는 시간이 걸린다.

## 가용성에 관련된 수치
**고가용성(high availability)** 은 시스템이 오랜 시간 동안 지속적으로 중단 없이 운영될 수 있는 능력을 지칭하는 용어다.  
고가용성은 퍼센트로 표현하는데 100%는 시스템이 단 한 번도 중단된 적이 없었음을 의미한다. 대부분 99%에서 100% 사이의 값을 갖는다.  
**SLA(Service Level Agreement)** 는 서비스 사업자가 보편적으로 사용하는 용어로, 서비스 사업자가 제공하는 서비스의 가용시간(uptime)이 공식적으로 기술되어있다.  
| 가용률 | 하루당 장애시간 | 주당 장애시간 | 개월당 장애시간 | 연간 장애시간 |
|----------|----------|----------|----------|----------|
| 99% | 14.40분 | 1.68시간 | 7.31시간 | 3.65일 |
| 99.9% | 1.44분 | 10.08분 | 43.83분 | 8.77시간 |
| 99.99% | 8.64초 | 1.01분 | 4.38분 | 52.60분 |
| 99.999% | 864.00밀리초 | 6.05초 | 26.30초 | 5.26분 |
| 99.9999% | 86.40밀리초 | 604.80밀리초 | 2.63초 | 31.56초 |

## 추정치 계산
가정
- 월간 능동 사용자(monthly active user)는 3억(300million)명이다.
- 50%의 사용자가 트위터를 매일 사용한다.
- 평균적으로 각 사용자는 매일 2건의 트윗을 올린다.
- 미디어를 포함한 트윗은 10% 정도다.
- 데이터는 5년간 보관된다.

추정
QPS(Query Per Second) 추정치
- 일간 능동 사용자(Daily Active User, DAU) = 3억 x 50% = 1.5억(150million)
- QPS = 1.5억 x 2 트윗 / 24시간 / 3600초 = 약 3500
- 최대 QPS(Peek QPS) = 2 x QPS = 약 7000

미디어 저장을 위한 저장소 요구량
- 평균 트윗 크기
  - tweet_id 에 140바이트
  - text 에 140바이트
  - 미디어 에 1MB
- 미디어 저장소 요구량: 1.5억 x 2 x 10% x 1 MB = 30TB/일
- 5년간 미디어를 보관하기 위한 저장소 요구량: 30TB x 365 x 5 = 약 55PB
